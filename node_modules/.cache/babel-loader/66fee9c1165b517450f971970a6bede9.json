{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport PhotoSwipe from 'photoswipe';\nimport React, { useRef, useCallback, useEffect, useMemo, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport sortNodes from \"./helpers/sort-nodes.js\";\nimport objectToHash from \"./helpers/object-to-hash.js\";\nimport hashToObject from \"./helpers/hash-to-object.js\";\nimport getHashWithoutGidAndPid from \"./helpers/get-hash-without-gid-and-pid.js\";\nimport getHashValue from \"./helpers/get-hash-value.js\";\nimport getBaseUrl from \"./helpers/get-base-url.js\";\nimport { Context } from \"./context.js\";\nimport PhotoSwipeLightboxStub from \"./lightbox-stub.js\";\n/**\n * This variable stores the PhotoSwipe instance object\n * It aims to check whether does the PhotoSwipe opened at the moment\n * (analog of window.pswp in 'photoswipe/lightbox')\n */\n\nlet pswp = null;\n/**\n * Gallery component providing photoswipe context\n */\n\nexport const Gallery = ({\n  children,\n  options,\n  plugins,\n  uiElements,\n  id: galleryUID,\n  onBeforeOpen,\n  onOpen,\n  withCaption,\n  withDownloadButton\n}) => {\n  const [contentPortal, setContentPortal] = useState(null);\n  const items = useRef(new Map());\n  /**\n   * Store PID from hash if there are no items yet,\n   * but we need to open photoswipe if items appear in the next render\n   */\n\n  const openWhenReadyPid = useRef(null);\n  const open = useCallback((targetRef, targetId, itemIndex, e) => {\n    // only one photoswipe instance could be opened at once\n    // so if photoswipe is already open, function should do nothing\n    if (pswp) {\n      return;\n    }\n\n    let index = itemIndex || null;\n    const normalized = [];\n    const entries = Array.from(items.current);\n\n    const prepare = (entry, i) => {\n      const [ref, _a] = entry,\n            {\n        width,\n        height,\n        original,\n        originalSrcset,\n        thumbnail,\n        cropped,\n        content,\n        id: pid\n      } = _a,\n            rest = __rest(_a, [\"width\", \"height\", \"original\", \"originalSrcset\", \"thumbnail\", \"cropped\", \"content\", \"id\"]);\n\n      if (targetRef === ref || pid !== undefined && String(pid) === targetId) {\n        index = i;\n      }\n\n      normalized.push(Object.assign(Object.assign(Object.assign({\n        w: Number(width),\n        h: Number(height),\n        src: original,\n        srcset: originalSrcset,\n        msrc: thumbnail,\n        element: ref.current,\n        thumbCropped: cropped,\n        content\n      }, content !== undefined ? {\n        type: 'html'\n      } : {}), pid !== undefined ? {\n        pid\n      } : {}), rest));\n    };\n\n    if (items.current.size > 1) {\n      entries.sort(([{\n        current: a\n      }], [{\n        current: b\n      }]) => sortNodes(a, b)).forEach(prepare);\n    } else {\n      entries.forEach(prepare);\n    }\n\n    const initialPoint = e && e.clientX !== undefined && e.clientY !== undefined ? {\n      x: e.clientX,\n      y: e.clientY\n    } : null;\n    const instance = new PhotoSwipe(Object.assign({\n      dataSource: normalized,\n      index: index === null ? parseInt(targetId, 10) - 1 : index,\n      initialPointerPos: initialPoint\n    }, options || {}));\n    pswp = instance;\n    instance.on('contentActivate', ({\n      content: slideContent\n    }) => {\n      if (slideContent.data.content) {\n        setContentPortal(createPortal(slideContent.data.content, slideContent.element));\n      } else {\n        setContentPortal(null);\n      }\n    });\n    instance.on('close', () => {\n      setContentPortal(null);\n    });\n\n    if (withDownloadButton) {\n      instance.on('uiRegister', () => {\n        instance.ui.registerElement({\n          name: 'download-button',\n          ariaLabel: 'Download',\n          order: 8,\n          isButton: true,\n          tagName: 'a',\n          appendTo: 'bar',\n          html: {\n            isCustomSVG: true,\n            inner: '<path d=\"M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1ZM23 23H9v2h14Z\" id=\"pswp__icn-download\"/>',\n            outlineID: 'pswp__icn-download'\n          },\n          // can't test onInit callback correctly\n          onInit:\n          /* istanbul ignore next */\n          (el, pswpInstance) => {\n            el.setAttribute('download', '');\n            el.setAttribute('target', '_blank');\n            el.setAttribute('rel', 'noopener');\n            instance.on('change', () => {\n              const downloadButton = el;\n              downloadButton.href = pswpInstance.currSlide.data.src;\n            });\n          }\n        });\n      });\n    }\n\n    if (withCaption) {\n      instance.on('uiRegister', () => {\n        instance.ui.registerElement({\n          name: 'default-caption',\n          order: 9,\n          isButton: false,\n          appendTo: 'root',\n          // can't test onInit callback correctly\n          onInit:\n          /* istanbul ignore next */\n          (el, pswpInstance) => {\n            /* eslint-disable no-param-reassign */\n            el.style.position = 'absolute';\n            el.style.bottom = '15px';\n            el.style.left = '0';\n            el.style.right = '0';\n            el.style.padding = '0 20px';\n            el.style.color = 'var(--pswp-icon-color)';\n            el.style.textAlign = 'center';\n            el.style.fontSize = '14px';\n            el.style.lineHeight = '1.5';\n            el.style.textShadow = '1px 1px 3px var(--pswp-icon-color-secondary)';\n            /* eslint-enable no-param-reassign */\n\n            instance.on('change', () => {\n              const {\n                caption,\n                alt\n              } = pswpInstance.currSlide.data; // eslint-disable-next-line no-param-reassign\n\n              el.innerHTML = caption || alt || '';\n            });\n          }\n        });\n      });\n    }\n\n    if (Array.isArray(uiElements)) {\n      uiElements.forEach(uiElement => {\n        instance.on('uiRegister', () => {\n          instance.ui.registerElement(uiElement);\n        });\n      });\n    }\n\n    if (typeof plugins === 'function') {\n      plugins(new PhotoSwipeLightboxStub(instance));\n    }\n\n    if (typeof onBeforeOpen === 'function') {\n      onBeforeOpen(instance);\n    }\n\n    instance.on('change', () => {\n      if (galleryUID === undefined) {\n        return;\n      }\n\n      const pid = instance.currSlide.data.pid || instance.currIndex + 1;\n      const baseUrl = getBaseUrl();\n      const baseHash = getHashWithoutGidAndPid(getHashValue());\n      const gidAndPidHash = objectToHash({\n        gid: galleryUID,\n        pid\n      });\n      const urlWithOpenedSlide = `${baseUrl}#${baseHash}&${gidAndPidHash}`;\n      window.history.pushState({}, document.title, urlWithOpenedSlide);\n    });\n    instance.on('destroy', () => {\n      if (galleryUID !== undefined) {\n        const baseUrl = getBaseUrl();\n        const hash = getHashWithoutGidAndPid(getHashValue());\n        const urlWithoutOpenedSlide = `${baseUrl}${hash ? `#${hash}` : ''}`;\n        window.history.pushState({}, document.title, urlWithoutOpenedSlide);\n      }\n\n      pswp = null;\n    });\n    instance.init();\n\n    if (typeof onOpen === 'function') {\n      onOpen(instance);\n    }\n  }, [options, plugins, uiElements, galleryUID, onBeforeOpen, onOpen, withCaption, withDownloadButton]);\n  useEffect(() => {\n    return () => {\n      if (pswp) {\n        pswp.close();\n      }\n    };\n  }, []);\n  useEffect(() => {\n    if (galleryUID === undefined) {\n      return;\n    }\n\n    const hash = getHashValue();\n\n    if (hash.length < 5) {\n      return;\n    }\n\n    const params = hashToObject(hash);\n    const {\n      pid,\n      gid\n    } = params;\n\n    if (!pid || !gid) {\n      return;\n    }\n\n    if (items.current.size === 0) {\n      // no items currently, save PID from hash for future use\n      openWhenReadyPid.current = pid;\n      return;\n    }\n\n    if (pid && gid === String(galleryUID)) {\n      open(null, pid);\n    }\n  }, [open, galleryUID]);\n  const remove = useCallback(ref => {\n    items.current.delete(ref);\n  }, []);\n  const set = useCallback((ref, data) => {\n    const {\n      id\n    } = data;\n    items.current.set(ref, data);\n\n    if (openWhenReadyPid.current === null) {\n      return;\n    }\n\n    if (id === openWhenReadyPid.current) {\n      // user provided `id` prop of Item component\n      open(ref);\n      openWhenReadyPid.current = null;\n      return;\n    }\n\n    if (!id) {\n      // in this case we using index of item as PID\n      const index = parseInt(openWhenReadyPid.current, 10) - 1;\n      const refToOpen = Array.from(items.current.keys())[index];\n\n      if (refToOpen) {\n        open(refToOpen);\n        openWhenReadyPid.current = null;\n      }\n    }\n  }, [open]);\n  const openAt = useCallback(index => {\n    open(null, null, index);\n  }, [open]);\n  const contextValue = useMemo(() => ({\n    remove,\n    set,\n    handleClick: open,\n    open: openAt\n  }), [remove, set, open, openAt]);\n  return React.createElement(Context.Provider, {\n    value: contextValue\n  }, children, contentPortal);\n};\nGallery.propTypes = {\n  children: PropTypes.any,\n  options: PropTypes.object,\n  plugins: PropTypes.func,\n  uiElements: PropTypes.array,\n  id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  onBeforeOpen: PropTypes.func,\n  onOpen: PropTypes.func,\n  withCaption: PropTypes.bool,\n  withDownloadButton: PropTypes.bool\n};","map":{"version":3,"sources":["C:/Users/inter/Desktop/Desktop - Folders/Plantillas React/Templates Oficiales/Paginas en react/template-2/node_modules/react-photoswipe-gallery/dist/gallery.js"],"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","PhotoSwipe","React","useRef","useCallback","useEffect","useMemo","useState","createPortal","PropTypes","sortNodes","objectToHash","hashToObject","getHashWithoutGidAndPid","getHashValue","getBaseUrl","Context","PhotoSwipeLightboxStub","pswp","Gallery","children","options","plugins","uiElements","id","galleryUID","onBeforeOpen","onOpen","withCaption","withDownloadButton","contentPortal","setContentPortal","items","Map","openWhenReadyPid","open","targetRef","targetId","itemIndex","index","normalized","entries","Array","from","current","prepare","entry","ref","_a","width","height","original","originalSrcset","thumbnail","cropped","content","pid","rest","undefined","String","push","assign","w","Number","h","src","srcset","msrc","element","thumbCropped","type","size","sort","a","b","forEach","initialPoint","clientX","clientY","x","y","instance","dataSource","parseInt","initialPointerPos","on","slideContent","data","ui","registerElement","name","ariaLabel","order","isButton","tagName","appendTo","html","isCustomSVG","inner","outlineID","onInit","el","pswpInstance","setAttribute","downloadButton","href","currSlide","style","position","bottom","left","right","padding","color","textAlign","fontSize","lineHeight","textShadow","caption","alt","innerHTML","isArray","uiElement","currIndex","baseUrl","baseHash","gidAndPidHash","gid","urlWithOpenedSlide","window","history","pushState","document","title","hash","urlWithoutOpenedSlide","init","close","params","remove","delete","set","refToOpen","keys","openAt","contextValue","handleClick","createElement","Provider","value","propTypes","any","object","func","array","oneOfType","string","number","bool"],"mappings":"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","sourcesContent":["var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport PhotoSwipe from 'photoswipe';\nimport React, { useRef, useCallback, useEffect, useMemo, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport sortNodes from \"./helpers/sort-nodes.js\";\nimport objectToHash from \"./helpers/object-to-hash.js\";\nimport hashToObject from \"./helpers/hash-to-object.js\";\nimport getHashWithoutGidAndPid from \"./helpers/get-hash-without-gid-and-pid.js\";\nimport getHashValue from \"./helpers/get-hash-value.js\";\nimport getBaseUrl from \"./helpers/get-base-url.js\";\nimport { Context } from \"./context.js\";\nimport PhotoSwipeLightboxStub from \"./lightbox-stub.js\";\n/**\n * This variable stores the PhotoSwipe instance object\n * It aims to check whether does the PhotoSwipe opened at the moment\n * (analog of window.pswp in 'photoswipe/lightbox')\n */\n\nlet pswp = null;\n/**\n * Gallery component providing photoswipe context\n */\n\nexport const Gallery = ({\n  children,\n  options,\n  plugins,\n  uiElements,\n  id: galleryUID,\n  onBeforeOpen,\n  onOpen,\n  withCaption,\n  withDownloadButton\n}) => {\n  const [contentPortal, setContentPortal] = useState(null);\n  const items = useRef(new Map());\n  /**\n   * Store PID from hash if there are no items yet,\n   * but we need to open photoswipe if items appear in the next render\n   */\n\n  const openWhenReadyPid = useRef(null);\n  const open = useCallback((targetRef, targetId, itemIndex, e) => {\n    // only one photoswipe instance could be opened at once\n    // so if photoswipe is already open, function should do nothing\n    if (pswp) {\n      return;\n    }\n\n    let index = itemIndex || null;\n    const normalized = [];\n    const entries = Array.from(items.current);\n\n    const prepare = (entry, i) => {\n      const [ref, _a] = entry,\n            {\n        width,\n        height,\n        original,\n        originalSrcset,\n        thumbnail,\n        cropped,\n        content,\n        id: pid\n      } = _a,\n            rest = __rest(_a, [\"width\", \"height\", \"original\", \"originalSrcset\", \"thumbnail\", \"cropped\", \"content\", \"id\"]);\n\n      if (targetRef === ref || pid !== undefined && String(pid) === targetId) {\n        index = i;\n      }\n\n      normalized.push(Object.assign(Object.assign(Object.assign({\n        w: Number(width),\n        h: Number(height),\n        src: original,\n        srcset: originalSrcset,\n        msrc: thumbnail,\n        element: ref.current,\n        thumbCropped: cropped,\n        content\n      }, content !== undefined ? {\n        type: 'html'\n      } : {}), pid !== undefined ? {\n        pid\n      } : {}), rest));\n    };\n\n    if (items.current.size > 1) {\n      entries.sort(([{\n        current: a\n      }], [{\n        current: b\n      }]) => sortNodes(a, b)).forEach(prepare);\n    } else {\n      entries.forEach(prepare);\n    }\n\n    const initialPoint = e && e.clientX !== undefined && e.clientY !== undefined ? {\n      x: e.clientX,\n      y: e.clientY\n    } : null;\n    const instance = new PhotoSwipe(Object.assign({\n      dataSource: normalized,\n      index: index === null ? parseInt(targetId, 10) - 1 : index,\n      initialPointerPos: initialPoint\n    }, options || {}));\n    pswp = instance;\n    instance.on('contentActivate', ({\n      content: slideContent\n    }) => {\n      if (slideContent.data.content) {\n        setContentPortal(createPortal(slideContent.data.content, slideContent.element));\n      } else {\n        setContentPortal(null);\n      }\n    });\n    instance.on('close', () => {\n      setContentPortal(null);\n    });\n\n    if (withDownloadButton) {\n      instance.on('uiRegister', () => {\n        instance.ui.registerElement({\n          name: 'download-button',\n          ariaLabel: 'Download',\n          order: 8,\n          isButton: true,\n          tagName: 'a',\n          appendTo: 'bar',\n          html: {\n            isCustomSVG: true,\n            inner: '<path d=\"M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1ZM23 23H9v2h14Z\" id=\"pswp__icn-download\"/>',\n            outlineID: 'pswp__icn-download'\n          },\n          // can't test onInit callback correctly\n          onInit:\n          /* istanbul ignore next */\n          (el, pswpInstance) => {\n            el.setAttribute('download', '');\n            el.setAttribute('target', '_blank');\n            el.setAttribute('rel', 'noopener');\n            instance.on('change', () => {\n              const downloadButton = el;\n              downloadButton.href = pswpInstance.currSlide.data.src;\n            });\n          }\n        });\n      });\n    }\n\n    if (withCaption) {\n      instance.on('uiRegister', () => {\n        instance.ui.registerElement({\n          name: 'default-caption',\n          order: 9,\n          isButton: false,\n          appendTo: 'root',\n          // can't test onInit callback correctly\n          onInit:\n          /* istanbul ignore next */\n          (el, pswpInstance) => {\n            /* eslint-disable no-param-reassign */\n            el.style.position = 'absolute';\n            el.style.bottom = '15px';\n            el.style.left = '0';\n            el.style.right = '0';\n            el.style.padding = '0 20px';\n            el.style.color = 'var(--pswp-icon-color)';\n            el.style.textAlign = 'center';\n            el.style.fontSize = '14px';\n            el.style.lineHeight = '1.5';\n            el.style.textShadow = '1px 1px 3px var(--pswp-icon-color-secondary)';\n            /* eslint-enable no-param-reassign */\n\n            instance.on('change', () => {\n              const {\n                caption,\n                alt\n              } = pswpInstance.currSlide.data; // eslint-disable-next-line no-param-reassign\n\n              el.innerHTML = caption || alt || '';\n            });\n          }\n        });\n      });\n    }\n\n    if (Array.isArray(uiElements)) {\n      uiElements.forEach(uiElement => {\n        instance.on('uiRegister', () => {\n          instance.ui.registerElement(uiElement);\n        });\n      });\n    }\n\n    if (typeof plugins === 'function') {\n      plugins(new PhotoSwipeLightboxStub(instance));\n    }\n\n    if (typeof onBeforeOpen === 'function') {\n      onBeforeOpen(instance);\n    }\n\n    instance.on('change', () => {\n      if (galleryUID === undefined) {\n        return;\n      }\n\n      const pid = instance.currSlide.data.pid || instance.currIndex + 1;\n      const baseUrl = getBaseUrl();\n      const baseHash = getHashWithoutGidAndPid(getHashValue());\n      const gidAndPidHash = objectToHash({\n        gid: galleryUID,\n        pid\n      });\n      const urlWithOpenedSlide = `${baseUrl}#${baseHash}&${gidAndPidHash}`;\n      window.history.pushState({}, document.title, urlWithOpenedSlide);\n    });\n    instance.on('destroy', () => {\n      if (galleryUID !== undefined) {\n        const baseUrl = getBaseUrl();\n        const hash = getHashWithoutGidAndPid(getHashValue());\n        const urlWithoutOpenedSlide = `${baseUrl}${hash ? `#${hash}` : ''}`;\n        window.history.pushState({}, document.title, urlWithoutOpenedSlide);\n      }\n\n      pswp = null;\n    });\n    instance.init();\n\n    if (typeof onOpen === 'function') {\n      onOpen(instance);\n    }\n  }, [options, plugins, uiElements, galleryUID, onBeforeOpen, onOpen, withCaption, withDownloadButton]);\n  useEffect(() => {\n    return () => {\n      if (pswp) {\n        pswp.close();\n      }\n    };\n  }, []);\n  useEffect(() => {\n    if (galleryUID === undefined) {\n      return;\n    }\n\n    const hash = getHashValue();\n\n    if (hash.length < 5) {\n      return;\n    }\n\n    const params = hashToObject(hash);\n    const {\n      pid,\n      gid\n    } = params;\n\n    if (!pid || !gid) {\n      return;\n    }\n\n    if (items.current.size === 0) {\n      // no items currently, save PID from hash for future use\n      openWhenReadyPid.current = pid;\n      return;\n    }\n\n    if (pid && gid === String(galleryUID)) {\n      open(null, pid);\n    }\n  }, [open, galleryUID]);\n  const remove = useCallback(ref => {\n    items.current.delete(ref);\n  }, []);\n  const set = useCallback((ref, data) => {\n    const {\n      id\n    } = data;\n    items.current.set(ref, data);\n\n    if (openWhenReadyPid.current === null) {\n      return;\n    }\n\n    if (id === openWhenReadyPid.current) {\n      // user provided `id` prop of Item component\n      open(ref);\n      openWhenReadyPid.current = null;\n      return;\n    }\n\n    if (!id) {\n      // in this case we using index of item as PID\n      const index = parseInt(openWhenReadyPid.current, 10) - 1;\n      const refToOpen = Array.from(items.current.keys())[index];\n\n      if (refToOpen) {\n        open(refToOpen);\n        openWhenReadyPid.current = null;\n      }\n    }\n  }, [open]);\n  const openAt = useCallback(index => {\n    open(null, null, index);\n  }, [open]);\n  const contextValue = useMemo(() => ({\n    remove,\n    set,\n    handleClick: open,\n    open: openAt\n  }), [remove, set, open, openAt]);\n  return React.createElement(Context.Provider, {\n    value: contextValue\n  }, children, contentPortal);\n};\nGallery.propTypes = {\n  children: PropTypes.any,\n  options: PropTypes.object,\n  plugins: PropTypes.func,\n  uiElements: PropTypes.array,\n  id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  onBeforeOpen: PropTypes.func,\n  onOpen: PropTypes.func,\n  withCaption: PropTypes.bool,\n  withDownloadButton: PropTypes.bool\n};"]},"metadata":{},"sourceType":"module"}